---
/**
 * SoundSwitcher Component
 * Supports multiple instances by using classes instead of IDs.
 */
---

<button class="sound-toggle-btn hover:text-accent p-1 transition-colors focus:outline-none" aria-label="Toggle sound">
	<span class="sound-on-icon icon-[tabler--volume] size-4"></span>
	<span class="sound-off-icon icon-[tabler--volume-off] hidden size-4"></span>
</button>

<script>
	import { sound } from "@core/Sound";

	function updateSoundIcons() {
		const isMuted = sound.getMuteState();
		document.querySelectorAll(".sound-toggle-btn").forEach((btn) => {
			const onIcon = btn.querySelector(".sound-on-icon");
			const offIcon = btn.querySelector(".sound-off-icon");
			if (isMuted) {
				onIcon?.classList.add("hidden");
				offIcon?.classList.remove("hidden");
			} else {
				onIcon?.classList.remove("hidden");
				offIcon?.classList.add("hidden");
			}
		});
	}

	function toggleSound() {
		const isMuted = sound.toggleMute();
		updateSoundIcons();
		if (!isMuted) sound.playBlip();
	}

	// Init
	updateSoundIcons();

	// Listeners
	document.querySelectorAll(".sound-toggle-btn").forEach((btn) => {
		btn.addEventListener("click", toggleSound);
	});
</script>
