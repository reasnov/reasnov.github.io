---
interface Props {
	title: string;
	icons: any[];
	accentColor?: "green" | "amber" | "cyan" | "magenta" | "blue";
}

const { title, icons, accentColor = "green" } = Astro.props;

const colorMap = {
	green: { bg: "bg-t-green/5", border: "group-hover:border-t-green", text: "text-t-green", dot: "bg-t-green" },
	amber: { bg: "bg-t-amber/5", border: "group-hover:border-t-amber", text: "text-t-amber", dot: "bg-t-amber" },
	cyan: { bg: "bg-t-cyan/5", border: "group-hover:border-t-cyan", text: "text-t-cyan", dot: "bg-t-cyan" },
	magenta: {
		bg: "bg-t-magenta/5",
		border: "group-hover:border-t-magenta",
		text: "text-t-magenta",
		dot: "bg-t-magenta",
	},
	blue: { bg: "bg-t-blue/5", border: "group-hover:border-t-blue", text: "text-t-blue", dot: "bg-t-blue" },
};

const theme = colorMap[accentColor];
---

<div class="flex w-full flex-col gap-3">
	<div class="flex items-center gap-3 px-1">
		<span
			class={`px-3 py-1 text-[9px] font-black tracking-widest text-primary-content uppercase md:text-[10px] ${theme.dot.replace("bg-", "bg-")}`}
		>
			{title}
		</span>
		<div class="bg-border/10 h-px flex-1"></div>
		<span class={`tui-status-dot ${theme.dot}`}></span>
	</div>

	<div class="relative">
		<!-- Scroll Fade Indicators -->
		<div
			class="from-base pointer-events-none absolute inset-y-0 left-0 z-10 w-8 bg-gradient-to-r to-transparent opacity-0 transition-opacity duration-300"
			id={`fade-l-${title.replace(/\s+/g, "")}`}
		>
		</div>
		<div
			class="from-base pointer-events-none absolute inset-y-0 right-0 z-10 w-8 bg-gradient-to-l to-transparent opacity-100 transition-opacity duration-300"
			id={`fade-r-${title.replace(/\s+/g, "")}`}
		>
		</div>

		<div
			class="custom-scrollbar border-border/5 bg-primary/5 flex w-full flex-nowrap items-center gap-4 overflow-x-auto border-2 p-4 sm:gap-6 sm:p-6"
			id={`scroll-area-${title.replace(/\s+/g, "")}`}
		>
			{
				icons.map((icon: { icon: string; name: string }) => (
					<div class="group flex shrink-0 flex-col items-center gap-2 transition-all" title={icon.name}>
						<div class="border-border/10 bg-base group-hover:bg-primary/5 group-hover:border-accent flex size-14 items-center justify-center border-2 grayscale transition-all group-hover:grayscale-0 sm:size-16">
							<span
								class={`${icon.icon} size-8 opacity-40 transition-all group-hover:scale-110 group-hover:opacity-100 sm:size-10`}
							/>
						</div>
						<span
							class={`text-[8px] font-bold uppercase opacity-0 transition-opacity group-hover:opacity-100 ${theme.text}`}
						>
							{icon.name}
						</span>
					</div>
				))
			}
		</div>
	</div>

	<script define:vars={{ title }}>
		const areaId = `scroll-area-${title.replace(/\s+/g, "")}`;
		const fadeLId = `fade-l-${title.replace(/\s+/g, "")}`;
		const fadeRId = `fade-r-${title.replace(/\s+/g, "")}`;

		const area = document.getElementById(areaId);
		const fadeL = document.getElementById(fadeLId);
		const fadeR = document.getElementById(fadeRId);

		if (area) {
			area.addEventListener("scroll", () => {
				const scrollLeft = area.scrollLeft;
				const maxScroll = area.scrollWidth - area.clientWidth;

				if (fadeL) fadeL.style.opacity = scrollLeft > 10 ? "1" : "0";
				if (fadeR) fadeR.style.opacity = scrollLeft < maxScroll - 10 ? "1" : "0";
			});
		}
	</script>
</div>
