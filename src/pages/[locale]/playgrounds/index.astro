---
import AppLayout from "@layouts/AppLayout.astro";
import { trans } from "@core/Translator";
import playgrounds from "@data/playgrounds.json";
import SpaceShooter from "@components/ui/SpaceShooter.astro";

export function getStaticPaths() {
	return [{ params: { locale: "en" } }, { params: { locale: "id" } }];
}

const locale = Astro.currentLocale || "en";
---

<AppLayout title={trans("pages.playgrounds.title", {}, locale)}>
	<SpaceShooter manual={true} />
	<section class="my-10 flex flex-col gap-12" data-aos="fade-in">
		<!-- Breadcrumb / Directory Style Header -->
		<div class="flex flex-col gap-2">
			<div class="flex items-center gap-2 text-[10px] font-bold tracking-widest text-neutral-500 uppercase">
				<span>ROOT</span>
				<span>/</span>
				<span>PLAYGROUNDS</span>
				<span>/</span>
				<span class="text-black underline dark:text-white">{locale.toUpperCase()}</span>
			</div>
			<div class="mt-4 flex flex-col gap-4 border-l-4 border-black pl-6 dark:border-white">
				<h1 class="text-4xl leading-none font-black tracking-tighter uppercase md:text-6xl">
					{trans("pages.playgrounds.title", {}, locale)}
				</h1>
				<p class="text-xs font-bold tracking-widest text-neutral-500 uppercase md:text-sm">
					// {trans("pages.playgrounds.subtitle", {}, locale)}
				</p>
			</div>
		</div>

		<!-- Experiments Grid -->
		<div class="grid grid-cols-1 gap-8 md:grid-cols-2 lg:grid-cols-3">
			{
				playgrounds.map((item, index) => (
					<div
						class="tui-window group flex flex-col transition-transform duration-300 hover:-translate-y-2"
						data-aos="fade-up"
						data-aos-delay={index * 100}
					>
						<div class="tui-window-header">
							<div class="flex items-center gap-2">
								<span class="icon-[tabler--flask] size-3" />
								<span>EXP_{String(index + 1).padStart(3, "0")}.EXE</span>
							</div>
							<div class="flex gap-1">
								<div class="size-2 border border-white/30 dark:border-black/30" />
								<div class="size-2 border border-white/30 dark:border-black/30" />
							</div>
						</div>

						<div class="flex flex-1 flex-col gap-4 p-6">
							<div class="flex items-center justify-between">
								<div class="flex flex-wrap gap-1">
									{item.tags.map((tag) => (
										<span class="border-border border px-1 text-[8px] font-bold uppercase opacity-40">
											{tag}
										</span>
									))}
								</div>
								<span class="text-[8px] font-black opacity-20 transition-opacity group-hover:opacity-100">
									v1.0.0
								</span>
							</div>

							<h2 class="text-xl font-bold tracking-tight uppercase decoration-2 group-hover:underline">
								{item.title}
							</h2>

							<p class="text-fg/60 flex-1 text-xs leading-relaxed italic">&gt; {item.description}</p>

							<a href={item.link} target="_blank" class="tui-btn-primary tui-btn-sm mt-4 w-full">
								{trans("pages.playgrounds.button", {}, locale)}
							</a>
						</div>

						{/* Bottom Info Bar */}
						<div class="border-border bg-primary/5 flex items-center justify-between border-t px-3 py-1">
							<span class="text-fg/40 text-[7px] font-bold tracking-tighter uppercase">
								ACCESS: PUBLIC
							</span>
							<div class="flex gap-1">
								<span class="bg-fg size-1.5 animate-pulse" />
							</div>
						</div>
					</div>
				))
			}
		</div>

		<!-- Footer Stats -->
		<div
			class="tui-panel mt-8 flex items-center justify-between border-dashed border-neutral-300 px-4 py-2 dark:border-neutral-800"
		>
			<span class="text-[9px] font-bold text-neutral-500">USER@REASVYN:~/playgrounds$ ls -la</span>
			<span class="text-[9px] font-bold tracking-widest text-neutral-500 uppercase"
				>{playgrounds.length} EXPERIMENTS_FOUND</span
			>
		</div>
	</section>
</AppLayout>

<script>
	const runGameLink = document.querySelector('a[href="#run-integrity-check"]');
	const gameSplash = document.getElementById("game-splash");

	runGameLink?.addEventListener("click", (e) => {
		e.preventDefault();
		if (gameSplash) {
			gameSplash.classList.remove("hidden");
			document.body.style.overflow = "hidden";
			// Dispatch a custom event to tell the game to reset or re-init if needed
			window.dispatchEvent(new CustomEvent("trigger-game-reset"));
		}
	});
</script>
